From: Russell Coker <russell@coker.com.au>
Date: Mon, 20 Feb 2012 21:46:21 +0100
Subject: Make usage of deprecated interfaces fatal

---
 policy/modules/kernel/corenetwork.if.in |   14 +++++++-------
 policy/modules/kernel/devices.if        |    4 ++--
 policy/modules/kernel/kernel.if         |    6 +++---
 policy/modules/kernel/terminal.if       |   30 +++++++++++++++---------------
 policy/modules/services/automount.if    |    2 +-
 policy/modules/services/bind.if         |    2 +-
 policy/modules/services/bluetooth.if    |    4 ++--
 policy/modules/services/cups.if         |    2 +-
 policy/modules/services/dictd.if        |    2 +-
 policy/modules/services/finger.if       |    2 +-
 policy/modules/services/ftp.if          |    2 +-
 policy/modules/services/i18n_input.if   |    2 +-
 policy/modules/services/inetd.if        |    4 ++--
 policy/modules/services/jabber.if       |    2 +-
 policy/modules/services/ldap.if         |    2 +-
 policy/modules/services/mta.if          |    2 +-
 policy/modules/services/nessus.if       |    2 +-
 policy/modules/services/nis.if          |    4 ++--
 policy/modules/services/nsd.if          |    4 ++--
 policy/modules/services/perdition.if    |    2 +-
 policy/modules/services/portmap.if      |    6 +++---
 policy/modules/services/radius.if       |    2 +-
 policy/modules/services/rpc.if          |    4 ++--
 policy/modules/services/snmp.if         |    4 ++--
 policy/modules/services/soundserver.if  |    2 +-
 policy/modules/services/squid.if        |    2 +-
 policy/modules/services/ssh.if          |    2 +-
 policy/modules/services/xserver.if      |    4 ++--
 policy/support/loadable_module.spt      |    2 +-
 policy/support/misc_patterns.spt        |    2 +-
 policy/support/obj_perm_sets.spt        |   18 +++++++++---------
 31 files changed, 71 insertions(+), 71 deletions(-)

--- a/policy/modules/kernel/corenetwork.if.in
+++ b/policy/modules/kernel/corenetwork.if.in
@@ -2123,77 +2123,6 @@
 
 ########################################
 ## <summary>
-##	Send and receive messages on a
-##	non-encrypted (no IPSEC) network
-##	session.
-## </summary>
-## <desc>
-##	<p>
-##	Send and receive messages on a
-##	non-encrypted (no IPSEC) network
-##	session.  (Deprecated)
-##	</p>
-##	<p>
-##	The corenet_all_recvfrom_unlabeled() interface should be used instead
-##	of this one.
-##	</p>
-## </desc>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`corenet_non_ipsec_sendrecv',`
-	refpolicywarn(`$0($*) has been deprecated, use corenet_all_recvfrom_unlabeled() instead.')
-	corenet_all_recvfrom_unlabeled($1)
-')
-
-########################################
-## <summary>
-##	Do not audit attempts to send and receive
-##	messages on a non-encrypted (no IPSEC) network
-##	session.
-## </summary>
-## <desc>
-##	<p>
-##	Do not audit attempts to send and receive
-##	messages on a non-encrypted (no IPSEC) network
-##	session.
-##	</p>
-##	<p>
-##	The corenet_dontaudit_all_recvfrom_unlabeled() interface should be
-##	used instead of this one.
-##	</p>
-## </desc>
-## <param name="domain">
-##	<summary>
-##	Domain to not audit.
-##	</summary>
-## </param>
-#
-interface(`corenet_dontaudit_non_ipsec_sendrecv',`
-	refpolicywarn(`$0($*) has been deprecated, use corenet_dontaudit_all_recvfrom_unlabeled() instead.')
-	corenet_dontaudit_all_recvfrom_unlabeled($1)
-')
-
-########################################
-## <summary>
-##	Receive TCP packets from a NetLabel connection.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`corenet_tcp_recv_netlabel',`
-	refpolicywarn(`$0($*) has been deprecated, use corenet_tcp_recvfrom_netlabel() instead.')
-	corenet_tcp_recvfrom_netlabel($1)
-')
-
-########################################
-## <summary>
 ##	Receive TCP packets from a NetLabel connection.
 ## </summary>
 ## <param name="domain">
@@ -2242,22 +2171,6 @@
 ##	</summary>
 ## </param>
 #
-interface(`corenet_dontaudit_tcp_recv_netlabel',`
-	refpolicywarn(`$0($*) has been deprecated, use corenet_dontaudit_tcp_recvfrom_netlabel() instead.')
-	corenet_dontaudit_tcp_recvfrom_netlabel($1)
-')
-
-########################################
-## <summary>
-##	Do not audit attempts to receive TCP packets from a NetLabel
-##	connection.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain to not audit.
-##	</summary>
-## </param>
-#
 interface(`corenet_dontaudit_tcp_recvfrom_netlabel',`
 	gen_require(`
 		type netlabel_peer_t;
@@ -2298,21 +2211,6 @@
 ##	</summary>
 ## </param>
 #
-interface(`corenet_udp_recv_netlabel',`
-	refpolicywarn(`$0($*) has been deprecated, use corenet_udp_recvfrom_netlabel() instead.')
-	corenet_udp_recvfrom_netlabel($1)
-')
-
-########################################
-## <summary>
-##	Receive UDP packets from a NetLabel connection.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
 interface(`corenet_udp_recvfrom_netlabel',`
 	gen_require(`
 		type netlabel_peer_t;
@@ -2353,22 +2251,6 @@
 ##	</summary>
 ## </param>
 #
-interface(`corenet_dontaudit_udp_recv_netlabel',`
-	refpolicywarn(`$0($*) has been deprecated, use corenet_dontaudit_udp_recvfrom_netlabel($1) instead.')
-	corenet_dontaudit_udp_recvfrom_netlabel($1)
-')
-
-########################################
-## <summary>
-##	Do not audit attempts to receive UDP packets from a NetLabel
-##	connection.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain to not audit.
-##	</summary>
-## </param>
-#
 interface(`corenet_dontaudit_udp_recvfrom_netlabel',`
 	gen_require(`
 		type netlabel_peer_t;
@@ -2409,21 +2291,6 @@
 ##	</summary>
 ## </param>
 #
-interface(`corenet_raw_recv_netlabel',`
-	refpolicywarn(`$0($*) has been deprecated, use corenet_raw_recvfrom_netlabel() instead.')
-	corenet_raw_recvfrom_netlabel($1)
-')
-
-########################################
-## <summary>
-##	Receive Raw IP packets from a NetLabel connection.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
 interface(`corenet_raw_recvfrom_netlabel',`
 	gen_require(`
 		type netlabel_peer_t;
@@ -2454,22 +2321,6 @@
 ')
 
 ########################################
-## <summary>
-##	Do not audit attempts to receive Raw IP packets from a NetLabel
-##	connection.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain to not audit.
-##	</summary>
-## </param>
-#
-interface(`corenet_dontaudit_raw_recv_netlabel',`
-	refpolicywarn(`$0($*) has been deprecated, use corenet_dontaudit_raw_recvfrom_netlabel() instead.')
-	corenet_dontaudit_raw_recvfrom_netlabel($1)
-')
-
-########################################
 ## <summary>
 ##	Do not audit attempts to receive Raw IP packets from a NetLabel
 ##	connection.
--- a/policy/modules/kernel/devices.if
+++ b/policy/modules/kernel/devices.if
@@ -2859,64 +2859,6 @@
 
 ########################################
 ## <summary>
-##	Read the memory type range
-##	registers (MTRR).  (Deprecated)
-## </summary>
-## <desc>
-##	<p>
-##	Read the memory type range
-##	registers (MTRR).  This interface has
-##	been deprecated, dev_rw_mtrr() should be
-##	used instead.
-##	</p>
-##	<p>
-##	The MTRR device ioctls can be used for
-##	reading and writing; thus, read access to the
-##	device cannot be separated from write access.
-##	</p>
-## </desc>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`dev_read_mtrr',`
-	refpolicywarn(`$0($*) has been replaced with dev_rw_mtrr().')
-	dev_rw_mtrr($1)
-')
-
-########################################
-## <summary>
-##	Write the memory type range
-##	registers (MTRR).  (Deprecated)
-## </summary>
-## <desc>
-##	<p>
-##	Write the memory type range
-##	registers (MTRR).  This interface has
-##	been deprecated, dev_rw_mtrr() should be
-##	used instead.
-##	</p>
-##	<p>
-##	The MTRR device ioctls can be used for
-##	reading and writing; thus, write access to the
-##	device cannot be separated from read access.
-##	</p>
-## </desc>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`dev_write_mtrr',`
-	refpolicywarn(`$0($*) has been replaced with dev_rw_mtrr().')
-	dev_rw_mtrr($1)
-')
-
-########################################
-## <summary>
 ##	Do not audit attempts to write the memory type
 ##	range registers (MTRR).
 ## </summary>
--- a/policy/modules/kernel/kernel.if
+++ b/policy/modules/kernel/kernel.if
@@ -290,48 +290,6 @@
 
 ########################################
 ## <summary>
-##	Receive messages from kernel TCP sockets.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`kernel_tcp_recvfrom',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
-##	Send UDP network traffic to the kernel.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`kernel_udp_send',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
-##	Receive messages from kernel UDP sockets.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`kernel_udp_recvfrom',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	Allows caller to load kernel modules
 ## </summary>
 ## <param name="domain">
--- a/policy/modules/kernel/terminal.if
+++ b/policy/modules/kernel/terminal.if
@@ -898,135 +898,6 @@
 
 ########################################
 ## <summary>
-##	Get the attributes of all user
-##	pty device nodes. (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-## <rolecap/>
-#
-interface(`term_getattr_all_user_ptys',`
-	refpolicywarn(`$0 has been deprecated, use term_getattr_all_ptys() instead.')
-	term_getattr_all_ptys($1)
-')
-
-########################################
-## <summary>
-##	Do not audit attempts to get the
-##	attributes of any user pty
-##	device nodes. (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`term_dontaudit_getattr_all_user_ptys',`
-	refpolicywarn(`$0 has been deprecated, use term_dontaudit_getattr_all_ptys() instead.')
-	term_dontaudit_getattr_all_ptys($1)
-')
-
-########################################
-## <summary>
-##	Set the attributes of all user
-##	pty device nodes. (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-## <rolecap/>
-#
-interface(`term_setattr_all_user_ptys',`
-	refpolicywarn(`$0 has been deprecated, use term_setattr_all_ptys() instead.')
-	term_setattr_all_ptys($1)
-')
-
-########################################
-## <summary>
-##	Relabel to all user ptys. (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`term_relabelto_all_user_ptys',`
-	refpolicywarn(`$0 has been deprecated, use term_relabelto_all_ptys() instead.')
-	term_relabelto_all_ptys($1)
-')
-
-########################################
-## <summary>
-##	Write to all user ptys. (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`term_write_all_user_ptys',`
-	refpolicywarn(`$0 has been deprecated, use term_write_all_ptys() instead.')
-	term_write_all_ptys($1)
-')
-
-########################################
-## <summary>
-##	Read and write all user ptys. (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-## <rolecap/>
-#
-interface(`term_use_all_user_ptys',`
-	refpolicywarn(`$0 has been deprecated, use term_use_all_ptys() instead.')
-	term_use_all_ptys($1)
-')
-
-########################################
-## <summary>
-##	Do not audit attempts to read any
-##	user ptys. (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain to not audit.
-##	</summary>
-## </param>
-#
-interface(`term_dontaudit_use_all_user_ptys',`
-	refpolicywarn(`$0 has been deprecated, use term_dontaudit_use_all_ptys() instead.')
-	term_dontaudit_use_all_ptys($1)
-')
-
-########################################
-## <summary>
-##	Relabel from and to all user
-##	user pty device nodes. (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`term_relabel_all_user_ptys',`
-	refpolicywarn(`$0 has been deprecated, use term_relabel_all_ptys() instead.')
-	term_relabel_all_ptys($1)
-')
-
-########################################
-## <summary>
 ##	Get the attributes of all unallocated
 ##	tty device nodes.
 ## </summary>
@@ -1379,117 +1250,3 @@
 
 	dontaudit $1 ttynode:chr_file rw_chr_file_perms;
 ')
-
-########################################
-## <summary>
-##	Get the attributes of all user tty
-##	device nodes. (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-## <rolecap/>
-#
-interface(`term_getattr_all_user_ttys',`
-	refpolicywarn(`$0() is deprecated, use term_getattr_all_ttys() instead.')
-	term_getattr_all_ttys($1)
-')
-
-########################################
-## <summary>
-##	Do not audit attempts to get the
-##	attributes of any user tty
-##	device nodes. (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain to not audit.
-##	</summary>
-## </param>
-#
-interface(`term_dontaudit_getattr_all_user_ttys',`
-	refpolicywarn(`$0() is deprecated, use term_dontaudit_getattr_all_ttys() instead.')
-	term_dontaudit_getattr_all_ttys($1)
-')
-
-########################################
-## <summary>
-##	Set the attributes of all user tty
-##	device nodes. (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-## <rolecap/>
-#
-interface(`term_setattr_all_user_ttys',`
-	refpolicywarn(`$0() is deprecated, use term_setattr_all_ttys() instead.')
-	term_setattr_all_ttys($1)
-')
-
-########################################
-## <summary>
-##	Relabel from and to all user
-##	user tty device nodes. (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`term_relabel_all_user_ttys',`
-	refpolicywarn(`$0() is deprecated, use term_relabel_all_ttys() instead.')
-	term_relabel_all_ttys($1)
-')
-
-########################################
-## <summary>
-##	Write to all user ttys. (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`term_write_all_user_ttys',`
-	refpolicywarn(`$0() is deprecated, use term_write_all_ttys() instead.')
-	term_write_all_ttys($1)
-')
-
-########################################
-## <summary>
-##	Read and write all user to all user ttys. (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-## <rolecap/>
-#
-interface(`term_use_all_user_ttys',`
-	refpolicywarn(`$0() is deprecated, use term_use_all_ttys() instead.')
-	term_use_all_ttys($1)
-')
-
-########################################
-## <summary>
-##	Do not audit attempts to read or write
-##	any user ttys. (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`term_dontaudit_use_all_user_ttys',`
-	refpolicywarn(`$0() is deprecated, use term_dontaudit_use_all_ttys() instead.')
-	term_dontaudit_use_all_ttys($1)
-')
--- a/policy/modules/services/automount.if
+++ b/policy/modules/services/automount.if
@@ -40,21 +40,6 @@
 
 ########################################
 ## <summary>
-##	Execute automount in the caller domain.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`automount_exec_config',`
-	refpolicywarn(`$0(): has been deprecated, please use files_exec_etc_files() instead.')
-	files_exec_etc_files($1)
-')
-
-########################################
-## <summary>
 ##	Allow the domain to read state files in /proc.
 ## </summary>
 ## <param name="domain">
--- a/policy/modules/services/bind.if
+++ b/policy/modules/services/bind.if
@@ -327,20 +327,6 @@
 
 ########################################
 ## <summary>
-##	Send and receive datagrams to and from named.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`bind_udp_chat_named',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	All of the rules required to administrate
 ##	an bind environment
 ## </summary>
--- a/policy/modules/services/bluetooth.if
+++ b/policy/modules/services/bluetooth.if
@@ -117,46 +117,6 @@
 
 ########################################
 ## <summary>
-##	Execute bluetooth_helper in the bluetooth_helper domain.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed to transition.
-##	</summary>
-## </param>
-#
-interface(`bluetooth_domtrans_helper',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
-##	Execute bluetooth_helper in the bluetooth_helper domain, and
-##	allow the specified role the bluetooth_helper domain.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed to transition.
-##	</summary>
-## </param>
-## <param name="role">
-##	<summary>
-##	Role allowed access.
-##	</summary>
-## </param>
-## <param name="terminal">
-##	<summary>
-##	The type of the terminal allow the bluetooth_helper domain to use.
-##	</summary>
-## </param>
-## <rolecap/>
-#
-interface(`bluetooth_run_helper',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	Read bluetooth helper state files.
 ## </summary>
 ## <param name="domain">
--- a/policy/modules/services/cups.if
+++ b/policy/modules/services/cups.if
@@ -66,20 +66,6 @@
 
 ########################################
 ## <summary>
-##	Connect to cups over TCP.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`cups_tcp_connect',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	Send and receive messages from
 ##	cups over dbus.
 ## </summary>
--- a/policy/modules/services/dictd.if
+++ b/policy/modules/services/dictd.if
@@ -2,21 +2,6 @@
 
 ########################################
 ## <summary>
-##	Use dictionary services by connecting
-##	over TCP.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`dictd_tcp_connect',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	All of the rules required to administrate 
 ##	an dictd environment
 ## </summary>
--- a/policy/modules/services/finger.if
+++ b/policy/modules/services/finger.if
@@ -17,17 +17,3 @@
 
 	domtrans_pattern($1, fingerd_exec_t, fingerd_t)
 ')
-
-########################################
-## <summary>
-##	Allow the specified domain to connect to fingerd with a tcp socket.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`finger_tcp_connect',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
--- a/policy/modules/services/ftp.if
+++ b/policy/modules/services/ftp.if
@@ -20,20 +20,6 @@
 
 ########################################
 ## <summary>
-##	Use ftp by connecting over TCP.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`ftp_tcp_connect',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	Read ftpd etc files
 ## </summary>
 ## <param name="domain">
--- a/policy/modules/services/i18n_input.if
+++ b/policy/modules/services/i18n_input.if
@@ -1,15 +1,2 @@
 ## <summary>IIIMF htt server</summary>
 
-########################################
-## <summary>
-##	Use i18n_input over a TCP connection.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`i18n_use',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
--- a/policy/modules/services/inetd.if
+++ b/policy/modules/services/inetd.if
@@ -141,20 +141,6 @@
 
 ########################################
 ## <summary>
-##	Connect to the inetd service using a TCP connection.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`inetd_tcp_connect',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	Run inetd child process in the inet child domain
 ## </summary>
 ## <param name="domain">
@@ -173,20 +159,6 @@
 ')
 
 ########################################
-## <summary>
-##	Send UDP network traffic to inetd.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`inetd_udp_send',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
 ## <summary>
 ##	Read and write inetd TCP sockets.
 ## </summary>
--- a/policy/modules/services/jabber.if
+++ b/policy/modules/services/jabber.if
@@ -2,20 +2,6 @@
 
 ########################################
 ## <summary>
-##	Connect to jabber over a TCP socket  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`jabber_tcp_connect',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	All of the rules required to administrate 
 ##	an jabber environment
 ## </summary>
--- a/policy/modules/services/ldap.if
+++ b/policy/modules/services/ldap.if
@@ -41,20 +41,6 @@
 
 ########################################
 ## <summary>
-##	Use LDAP over TCP connection.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`ldap_use',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	Connect to slapd over an unix stream socket.
 ## </summary>
 ## <param name="domain">
--- a/policy/modules/services/mta.if
+++ b/policy/modules/services/mta.if
@@ -576,20 +576,6 @@
 
 #######################################
 ## <summary>
-##	Connect to all mail servers over TCP.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`mta_tcp_connect_all_mailservers',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-#######################################
-## <summary>
 ##	Do not audit attempts to read a symlink
 ##	in the mail spool.
 ## </summary>
--- a/policy/modules/services/nessus.if
+++ b/policy/modules/services/nessus.if
@@ -1,15 +1,2 @@
 ## <summary>Nessus network scanning daemon</summary>
 
-########################################
-## <summary>
-##	Connect to nessus over a TCP socket  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`nessus_tcp_connect',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
--- a/policy/modules/services/nis.if
+++ b/policy/modules/services/nis.if
@@ -196,34 +196,6 @@
 
 ########################################
 ## <summary>
-##	Send UDP network traffic to NIS clients.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`nis_udp_send_ypbind',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
-##	Connect to ypbind over TCP.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`nis_tcp_connect_ypbind',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	Read ypbind pid files.
 ## </summary>
 ## <param name="domain">
--- a/policy/modules/services/nsd.if
+++ b/policy/modules/services/nsd.if
@@ -1,29 +1,2 @@
 ## <summary>Authoritative only name server</summary>
 
-########################################
-## <summary>
-##	Send and receive datagrams from NSD.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`nsd_udp_chat',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
-##	Connect to NSD over a TCP socket  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`nsd_tcp_connect',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
--- a/policy/modules/services/perdition.if
+++ b/policy/modules/services/perdition.if
@@ -1,15 +1,2 @@
 ## <summary>Perdition POP and IMAP proxy</summary>
 
-########################################
-## <summary>
-##	Connect to perdition over a TCP socket  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`perdition_tcp_connect',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
--- a/policy/modules/services/portmap.if
+++ b/policy/modules/services/portmap.if
@@ -45,45 +45,3 @@
 	portmap_domtrans_helper($1)
 	role $2 types portmap_helper_t;
 ')
-
-########################################
-## <summary>
-##	Send UDP network traffic to portmap.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`portmap_udp_send',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
-##	Send and receive UDP network traffic from portmap.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`portmap_udp_chat',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
-##	Connect to portmap over a TCP socket  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`portmap_tcp_connect',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
--- a/policy/modules/services/radius.if
+++ b/policy/modules/services/radius.if
@@ -2,20 +2,6 @@
 
 ########################################
 ## <summary>
-##	Use radius over a UDP connection.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`radius_use',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	All of the rules required to administrate
 ##	an radius environment
 ## </summary>
--- a/policy/modules/services/rpc.if
+++ b/policy/modules/services/rpc.if
@@ -124,20 +124,6 @@
 
 ########################################
 ## <summary>
-##	Send UDP network traffic to rpc and recieve UDP traffic from rpc.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`rpc_udp_send',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	Do not audit attempts to get the attributes
 ##	of the NFS export file.
 ## </summary>
@@ -364,20 +350,6 @@
 ')
 
 ########################################
-## <summary>
-##	Send UDP traffic to NFSd.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`rpc_udp_send_nfs',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
 ## <summary>
 ##	Search NFS state data in /var/lib/nfs.
 ## </summary>
--- a/policy/modules/services/snmp.if
+++ b/policy/modules/services/snmp.if
@@ -21,34 +21,6 @@
 
 ########################################
 ## <summary>
-##	Use snmp over a TCP connection.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`snmp_tcp_connect',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
-##	Send and receive UDP traffic to SNMP  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`snmp_udp_chat',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	Read snmpd libraries.
 ## </summary>
 ## <param name="domain">
--- a/policy/modules/services/soundserver.if
+++ b/policy/modules/services/soundserver.if
@@ -2,20 +2,6 @@
 
 ########################################
 ## <summary>
-##	Connect to the sound server over a TCP socket  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`soundserver_tcp_connect',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	All of the rules required to administrate 
 ##	an soundd environment
 ## </summary>
--- a/policy/modules/services/squid.if
+++ b/policy/modules/services/squid.if
@@ -175,20 +175,6 @@
 
 ########################################
 ## <summary>
-##	Use squid services by connecting over TCP.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`squid_use',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	All of the rules required to administrate 
 ##	an squid environment
 ## </summary>
--- a/policy/modules/services/ssh.if
+++ b/policy/modules/services/ssh.if
@@ -554,20 +554,6 @@
 
 ########################################
 ## <summary>
-##	Connect to SSH daemons over TCP sockets.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`ssh_tcp_connect',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	Execute the ssh daemon sshd domain.
 ## </summary>
 ## <param name="domain">
--- a/policy/modules/services/xserver.if
+++ b/policy/modules/services/xserver.if
@@ -265,65 +265,6 @@
 
 #######################################
 ## <summary>
-##	Create full client sessions
-##	on a user X server.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-## <param name="tmpfs_type">
-##	<summary>
-##	The type of the domain SYSV tmpfs files.
-##	</summary>
-## </param>
-#
-interface(`xserver_user_client',`
-	refpolicywarn(`$0() has been deprecated, please use xserver_user_x_domain_template instead.')
-	gen_require(`
-		type xdm_t, xdm_tmp_t;
-		type xauth_home_t, iceauth_home_t, xserver_t, xserver_tmpfs_t;
-	')
-
-	allow $1 self:shm create_shm_perms;
-	allow $1 self:unix_dgram_socket create_socket_perms;
-	allow $1 self:unix_stream_socket { connectto create_stream_socket_perms };
-
-	# Read .Xauthority file
-	allow $1 xauth_home_t:file { getattr read };
-	allow $1 iceauth_home_t:file { getattr read };
-
-	# for when /tmp/.X11-unix is created by the system
-	allow $1 xdm_t:fd use;
-	allow $1 xdm_t:fifo_file { getattr read write ioctl };
-	allow $1 xdm_tmp_t:dir search;
-	allow $1 xdm_tmp_t:sock_file { read write };
-	dontaudit $1 xdm_t:tcp_socket { read write };
-
-	# Allow connections to X server.
-	files_search_tmp($1)
-
-	miscfiles_read_fonts($1)
-
-	userdom_search_user_home_dirs($1)
-	# for .xsession-errors
-	userdom_dontaudit_write_user_home_content_files($1)
-
-	xserver_ro_session($1,$2)
-	xserver_use_user_fonts($1)
-
-	xserver_read_xdm_tmp_files($1)
-
-	# Client write xserver shm
-	tunable_policy(`allow_write_xshm',`
-		allow $1 xserver_t:shm rw_shm_perms;
-		allow $1 xserver_tmpfs_t:file rw_file_perms;
-	')
-')
-
-#######################################
-## <summary>
 ##	Interface to provide X object permissions on a given X server to
 ##	an X client domain.  Provides the minimal set required by a basic
 ##	X client application.
@@ -566,22 +507,6 @@
 ')
 
 ########################################
-## <summary>
-##	Read all users fonts, user font configurations,
-##	and manage all users font caches.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`xserver_use_all_users_fonts',`
-	refpolicywarn(`$0() has been deprecated, please use xserver_use_user_fonts.')
-	xserver_use_user_fonts($1)
-')
-
-########################################
 ## <summary>
 ##	Read all users .Xauthority.
 ## </summary>
--- a/policy/support/loadable_module.spt
+++ b/policy/support/loadable_module.spt
@@ -95,7 +95,7 @@
 #
 define(`optional_policy',`
 	ifelse(regexp(`$1',`\W'),`-1',`
-		refpolicywarn(`deprecated use of module name ($1) as first parameter of optional_policy() block.')
+		refpolicyerr(`deprecated use of module name ($1) as first parameter of optional_policy() block.')
 		optional_policy(shift($*))
 	',`
 		optional {`'pushdef(`__in_optional_policy')
--- a/policy/support/misc_patterns.spt
+++ b/policy/support/misc_patterns.spt
@@ -50,12 +50,6 @@
 #
 # Other process permissions
 #
-define(`send_audit_msgs_pattern',`
-	refpolicywarn(`$0($*) has been deprecated, please use logging_send_audit_msgs($1) instead.')
-	allow $1 self:capability audit_write;
-	allow $1 self:netlink_audit_socket { create_netlink_socket_perms nlmsg_relay };
-')
-
 define(`ps_process_pattern',`
 	allow $1 $2:dir list_dir_perms;
 	allow $1 $2:file read_file_perms;
--- a/policy/support/obj_perm_sets.spt
+++ b/policy/support/obj_perm_sets.spt
@@ -51,52 +51,6 @@
 # Macros for sets of permissions
 #
 
-# 
-# Permissions for getting file attributes.
-#
-define(`stat_file_perms', `{ getattr } refpolicywarn(`$0 is deprecated please use getattr_file_perms instead.')')
-
-# 
-# Permissions for executing files.
-#
-define(`x_file_perms', `{ getattr open execute } refpolicywarn(`$0 is deprecated please use { getattr execute } instead.')')
-
-# 
-# Permissions for reading files and their attributes.
-#
-define(`r_file_perms', `{ open read getattr lock ioctl } refpolicywarn(`$0 is deprecated please use read_file_perms instead.')')
-
-# 
-# Permissions for reading and executing files.
-#
-define(`rx_file_perms', `{ open read getattr lock execute ioctl } refpolicywarn(`$0 is deprecated please use { mmap_file_perms ioctl lock } instead.')')
-
-# 
-# Permissions for reading and appending to files.
-#
-define(`ra_file_perms', `{ open ioctl read getattr lock append } refpolicywarn(`$0 is deprecated please use { read_file_perms append_file_perms } instead.')')
-
-#
-# Permissions for linking, unlinking and renaming files.
-# 
-define(`link_file_perms', `{ getattr link unlink rename } refpolicywarn(`$0 is deprecated please use { getattr link unlink rename } instead.')')
-
-#
-# Permissions for creating lnk_files.
-#
-define(`create_lnk_perms', `{ create read write getattr setattr link unlink rename } refpolicywarn(`$0 is deprecated please use manage_lnk_file_perms instead.')')
-
-# 
-# Permissions for reading directories and their attributes.
-#
-define(`r_dir_perms', `{ open read getattr lock search ioctl } refpolicywarn(`$0 is deprecated please use list_dir_perms instead.')')
-
-# 
-# Permissions for reading and adding names to directories.
-#
-define(`ra_dir_perms', `{ open read getattr lock search ioctl add_name write } refpolicywarn(`$0 is deprecated please use { list_dir_perms add_entry_dir_perms } instead.')')
-
-
 #
 # Permissions to mount and unmount file systems.
 #
--- a/policy/modules/admin/certwatch.if
+++ b/policy/modules/admin/certwatch.if
@@ -47,32 +47,3 @@
 	certwatch_domtrans($1)
 	role $2 types certwatch_t;
 ')
-
-########################################
-## <summary>
-##	Execute certwatch in the certwatch domain, and
-##	allow the specified role the certwatch domain,
-##	and use the caller's terminal. Has a sigchld
-##	backchannel.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed to transition.
-##	</summary>
-## </param>
-## <param name="role">
-##	<summary>
-##	Role allowed access.
-##	</summary>
-## </param>
-## <param name="terminal">
-##	<summary>
-##	The type of the terminal allow the certwatch domain to use.
-##	</summary>
-## </param>
-## <rolecap/>
-#
-interface(`certwatach_run',`
-	refpolicywarn(`$0($*) has been deprecated, please use certwatch_run() instead.')
-	certwatch_run($*)
-')
--- a/policy/modules/kernel/corecommands.if
+++ b/policy/modules/kernel/corecommands.if
@@ -32,30 +32,6 @@
 
 ########################################
 ## <summary>
-##	Create a aliased type to generic bin files.  (Deprecated)
-## </summary>
-## <desc>
-##	<p>
-##	Create a aliased type to generic bin files.  (Deprecated)
-##	</p>
-##	<p>
-##	This is added to support targeted policy.  Its
-##	use should be limited.  It has no effect
-##	on the strict policy.
-##	</p>
-## </desc>
-## <param name="domain">
-##	<summary>
-##	Alias type for bin_t.
-##	</summary>
-## </param>
-#
-interface(`corecmd_bin_alias',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	Make general progams in bin an entrypoint for
 ##	the specified domain.
 ## </summary>
@@ -75,22 +51,6 @@
 
 ########################################
 ## <summary>
-##	Make general progams in sbin an entrypoint for
-##	the specified domain.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	The domain for which sbin programs are an entrypoint.
-##	</summary>
-## </param>
-#
-interface(`corecmd_sbin_entry_type',`
-	corecmd_bin_entry_type($1)
-	refpolicywarn(`$0() has been deprecated, please use corecmd_bin_entry_type() instead.')
-')
-
-########################################
-## <summary>
 ##	Make the shell an entrypoint for the specified domain.
 ## </summary>
 ## <param name="domain">
@@ -491,303 +451,6 @@
 
 ########################################
 ## <summary>
-##	Search the contents of sbin directories.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`corecmd_search_sbin',`
-	corecmd_search_bin($1)
-	refpolicywarn(`$0() has been deprecated, please use corecmd_search_bin() instead.')
-')
-
-########################################
-## <summary>
-##	Do not audit attempts to search
-##	sbin directories.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain to not audit.
-##	</summary>
-## </param>
-#
-interface(`corecmd_dontaudit_search_sbin',`
-	corecmd_dontaudit_search_bin($1)
-	refpolicywarn(`$0() has been deprecated, please use corecmd_dontaudit_search_bin() instead.')
-')
-
-########################################
-## <summary>
-##	List the contents of sbin directories.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`corecmd_list_sbin',`
-	corecmd_list_bin($1)
-	refpolicywarn(`$0() has been deprecated, please use corecmd_list_bin() instead.')
-')
-
-########################################
-## <summary>
-##	Do not audit attempts to write
-##	sbin directories.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain to not audit.
-##	</summary>
-## </param>
-#
-interface(`corecmd_dontaudit_write_sbin_dirs',`
-	corecmd_dontaudit_write_bin_dirs($1)
-	refpolicywarn(`$0() has been deprecated, please use corecmd_dontaudit_write_bin_dirs() instead.')
-')
-
-########################################
-## <summary>
-##	Get the attributes of sbin files.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`corecmd_getattr_sbin_files',`
-	corecmd_getattr_bin_files($1)
-	refpolicywarn(`$0() has been deprecated, please use corecmd_getattr_bin_files() instead.')
-')
-
-########################################
-## <summary>
-##	Do not audit attempts to get the attibutes
-##	of sbin files.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain to not audit.
-##	</summary>
-## </param>
-#
-interface(`corecmd_dontaudit_getattr_sbin_files',`
-	corecmd_dontaudit_getattr_bin_files($1)
-	refpolicywarn(`$0() has been deprecated, please use corecmd_dontaudit_getattr_bin_files() instead.')
-')
-
-########################################
-## <summary>
-##	Read files in sbin directories.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`corecmd_read_sbin_files',`
-	corecmd_read_bin_files($1)
-	refpolicywarn(`$0() has been deprecated, please use corecmd_read_bin_files() instead.')
-')
-
-########################################
-## <summary>
-##	Read symbolic links in sbin directories.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`corecmd_read_sbin_symlinks',`
-	corecmd_read_bin_symlinks($1)
-	refpolicywarn(`$0() has been deprecated, please use corecmd_read_bin_symlinks() instead.')
-')
-
-########################################
-## <summary>
-##	Read named pipes in sbin directories.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`corecmd_read_sbin_pipes',`
-	corecmd_read_bin_pipes($1)
-	refpolicywarn(`$0() has been deprecated, please use corecmd_read_bin_pipes() instead.')
-')
-
-########################################
-## <summary>
-##	Read named sockets in sbin directories.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`corecmd_read_sbin_sockets',`
-	corecmd_read_bin_sockets($1)
-	refpolicywarn(`$0() has been deprecated, please use corecmd_read_bin_sockets() instead.')
-')
-
-########################################
-## <summary>
-##	Execute generic programs in sbin directories,
-##	in the caller domain.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`corecmd_exec_sbin',`
-	corecmd_exec_bin($1)
-	refpolicywarn(`$0() has been deprecated, please use corecmd_exec_bin() instead.')
-')
-
-########################################
-## <summary>
-##	Create, read, write, and delete sbin files.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-# cjp: added for prelink
-interface(`corecmd_manage_sbin_files',`
-	corecmd_manage_bin_files($1)
-	refpolicywarn(`$0() has been deprecated, please use corecmd_manage_bin_files() instead.')
-')
-
-########################################
-## <summary>
-##	Relabel to and from the sbin type.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-# cjp: added for prelink
-interface(`corecmd_relabel_sbin_files',`
-	corecmd_relabel_bin_files($1)
-	refpolicywarn(`$0() has been deprecated, please use corecmd_relabel_bin_files() instead.')
-')
-
-########################################
-## <summary>
-##	Mmap a sbin file as executable.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-# cjp: added for prelink
-interface(`corecmd_mmap_sbin_files',`
-	corecmd_mmap_bin_files($1)
-	refpolicywarn(`$0() has been deprecated, please use corecmd_mmap_bin_files() instead.')
-')
-
-########################################
-## <summary>
-##	Execute a file in a sbin directory
-##	in the specified domain.  (Deprecated)
-## </summary>
-## <desc>
-##	<p>
-##	Execute a file in a sbin directory
-##	in the specified domain.  This allows
-##	the specified domain to execute any file
-##	on these filesystems in the specified
-##	domain.  This is not suggested.  (Deprecated)
-##	</p>
-##	<p>
-##	No interprocess communication (signals, pipes,
-##	etc.) is provided by this interface since
-##	the domains are not owned by this module.
-##	</p>
-##	<p>
-##	This interface was added to handle
-##	the ssh-agent policy.
-##	</p>
-## </desc>
-## <param name="domain">
-##	<summary>
-##	Domain allowed to transition.
-##	</summary>
-## </param>
-## <param name="target_domain">
-##	<summary>
-##	The type of the new process.
-##	</summary>
-## </param>
-#
-interface(`corecmd_sbin_domtrans',`
-	corecmd_bin_domtrans($1, $2)
-	refpolicywarn(`$0() has been deprecated, please use corecmd_bin_domtrans() instead.')
-')
-
-########################################
-## <summary>
-##	Execute a file in a sbin directory
-##	in the specified domain but do not
-##	do it automatically. This is an explicit
-##	transition, requiring the caller to use setexeccon().  (Deprecated)
-## </summary>
-## <desc>
-##	<p>
-##	Execute a file in a sbin directory
-##	in the specified domain.  This allows
-##	the specified domain to execute any file
-##	on these filesystems in the specified
-##	domain.  This is not suggested.  (Deprecated)
-##	</p>
-##	<p>
-##	No interprocess communication (signals, pipes,
-##	etc.) is provided by this interface since
-##	the domains are not owned by this module.
-##	</p>
-##	<p>
-##	This interface was added to handle
-##	the userhelper policy.
-##	</p>
-## </desc>
-## <param name="domain">
-##	<summary>
-##	Domain allowed to transition.
-##	</summary>
-## </param>
-## <param name="target_domain">
-##	<summary>
-##	The type of the new process.
-##	</summary>
-## </param>
-#
-interface(`corecmd_sbin_spec_domtrans',`
-	corecmd_bin_spec_domtrans($1, $2)
-	refpolicywarn(`$0() has been deprecated, please use corecmd_bin_spec_domtrans() instead.')
-')
-
-########################################
-## <summary>
 ##	Check if a shell is executable (DAC-wise).
 ## </summary>
 ## <param name="domain">
@@ -845,21 +508,6 @@
 ')
 
 ########################################
-## <summary>
-##	Execute ls in the caller domain.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`corecmd_exec_ls',`
-	corecmd_exec_bin($1)
-	refpolicywarn(`$0() has been deprecated, please use corecmd_exec_bin() instead.')
-')
-
-########################################
 ## <summary>
 ##	Execute a shell in the target domain.  This
 ##	is an explicit transition, requiring the
--- a/policy/modules/kernel/filesystem.if
+++ b/policy/modules/kernel/filesystem.if
@@ -1771,30 +1771,6 @@
 
 ########################################
 ## <summary>
-##	Read eventpollfs files.
-## </summary>
-## <desc>
-##	<p>
-##	Read eventpollfs files
-##	</p>
-##	<p>
-##	This interface has been deprecated, and will
-##	be removed in the future.
-##	</p>
-## </desc>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-# eventpollfs was changed to task SID 20060628
-interface(`fs_read_eventpollfs',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	Mount a FUSE filesystem.
 ## </summary>
 ## <param name="domain">
--- a/policy/modules/kernel/mls.if
+++ b/policy/modules/kernel/mls.if
@@ -34,32 +34,6 @@
 ########################################
 ## <summary>
 ##	Make specified domain MLS trusted
-##	for reading from files at all levels.  (Deprecated)
-## </summary>
-## <desc>
-##	<p>
-##	Make specified domain MLS trusted
-##	for reading from files at all levels.
-##	</p>
-##	<p>
-##	This interface has been deprecated, please use
-##	mls_file_read_all_levels() instead.
-##	</p>
-## </desc>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`mls_file_read_up',`
-	refpolicywarn(`$0($*) has been deprecated, please use mls_file_read_all_levels() instead.')
-	mls_file_read_all_levels($1)
-')
-
-########################################
-## <summary>
-##	Make specified domain MLS trusted
 ##	for reading from files at all levels.
 ## </summary>
 ## <param name="domain">
@@ -100,32 +74,6 @@
 ########################################
 ## <summary>
 ##	Make specified domain MLS trusted
-##	for writing to files at all levels.  (Deprecated)
-## </summary>
-## <desc>
-##	<p>
-##	Make specified domain MLS trusted
-##	for writing to files at all levels.
-##	</p>
-##	<p>
-##	This interface has been deprecated, please use
-##	mls_file_write_all_levels() instead.
-##	</p>
-## </desc>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`mls_file_write_down',`
-	refpolicywarn(`$0($*) has been deprecated, please use mls_file_write_all_levels() instead.')
-	mls_file_write_all_levels($1)
-')
-
-########################################
-## <summary>
-##	Make specified domain MLS trusted
 ##	for writing to files at all levels.
 ## </summary>
 ## <param name="domain">
@@ -520,32 +468,6 @@
 ########################################
 ## <summary>
 ##	Make specified domain MLS trusted
-##	for reading from processes at all levels.  (Deprecated)
-## </summary>
-## <desc>
-##	<p>
-##	Make specified domain MLS trusted
-##	for reading from processes at all levels.
-##	</p>
-##	<p>
-##	This interface has been deprecated, please use
-##	mls_process_read_all_levels() instead.
-##	</p>
-## </desc>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`mls_process_read_up',`
-#	refpolicywarn(`$0($*) has been deprecated, please use mls_process_read_all_levels() instead.')
-	mls_process_read_all_levels($1)
-')
-
-########################################
-## <summary>
-##	Make specified domain MLS trusted
 ##	for reading from processes at all levels.
 ## </summary>
 ## <param name="domain">
@@ -585,32 +507,6 @@
 ')
 
 ########################################
-## <summary>
-##	Make specified domain MLS trusted
-##	for writing to processes at all levels.  (Deprecated)
-## </summary>
-## <desc>
-##	<p>
-##	Make specified domain MLS trusted
-##	for writing to processes at all levels.
-##	</p>
-##	<p>
-##	This interface has been deprecated, please use
-##	mls_process_write_all_levels() instead.
-##	</p>
-## </desc>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`mls_process_write_down',`
-#	refpolicywarn(`$0($*) has been deprecated, please use mls_process_write_all_levels() instead.')
-	mls_process_write_all_levels($1)
-')
-
-########################################
 ## <summary>
 ##	Make specified domain MLS trusted
 ##	for writing to processes at all levels.
--- a/policy/modules/kernel/selinux.if
+++ b/policy/modules/kernel/selinux.if
@@ -378,38 +378,6 @@
 
 ########################################
 ## <summary>
-##	Allow caller to set the state of Booleans to
-##	enable or disable conditional portions of the policy.  (Deprecated)
-## </summary>
-## <desc>
-##	<p>
-##	Allow caller to set the state of Booleans to
-##	enable or disable conditional portions of the policy.
-##	</p>
-##	<p>
-##	Since this is a security event, this action is
-##	always audited.
-##	</p>
-##	<p>
-##	This interface has been deprecated.  Please use
-##	selinux_set_generic_booleans() or selinux_set_all_booleans()
-##	instead.
-##	</p>
-## </desc>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-## <rolecap/>
-#
-interface(`selinux_set_boolean',`
-	refpolicywarn(`$0($*) has been deprecated, use selinux_set_generic_booleans() instead.')
-	selinux_set_generic_booleans($1)
-')
-
-########################################
-## <summary>
 ##	Allow caller to set the state of generic Booleans to
 ##	enable or disable conditional portions of the policy.
 ## </summary>
--- a/policy/modules/system/authlogin.if
+++ b/policy/modules/system/authlogin.if
@@ -1210,28 +1210,6 @@
 
 ########################################
 ## <summary>
-##	Read all directories on the filesystem, except
-##	the shadow passwords and listed exceptions.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-## <param name="exception_types" optional="true">
-##	<summary>
-##	The types to be excluded.  Each type or attribute
-##	must be negated by the caller.
-##	</summary>
-## </param>
-#
-interface(`auth_read_all_dirs_except_shadow',`
-	refpolicywarn(`$0($*) has been deprecated, use auth_read_all_dirs_except_auth_files() instead.')
-	auth_read_all_dirs_except_auth_files($1, $2)
-')
-
-########################################
-## <summary>
 ##	Read all files on the filesystem, except
 ##	login files and listed exceptions.
 ## </summary>
@@ -1258,29 +1236,6 @@
 
 ########################################
 ## <summary>
-##	Read all files on the filesystem, except
-##	the shadow passwords and listed exceptions.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-## <param name="exception_types" optional="true">
-##	<summary>
-##	The types to be excluded.  Each type or attribute
-##	must be negated by the caller.
-##	</summary>
-## </param>
-## <rolecap/>
-#
-interface(`auth_read_all_files_except_shadow',`
-	refpolicywarn(`$0($*) has been deprecated, use auth_read_all_files_except_auth_files() instead.')
-	auth_read_all_files_except_auth_files($1, $2)
-')
-
-########################################
-## <summary>
 ##	Read all symbolic links on the filesystem, except
 ##	login files and listed exceptions.
 ## </summary>
@@ -1304,28 +1259,6 @@
 	files_read_all_symlinks_except($1, $2 -auth_file_type)
 ')
 
-########################################
-## <summary>
-##	Read all symbolic links on the filesystem, except
-##	the shadow passwords and listed exceptions.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-## <param name="exception_types" optional="true">
-##	<summary>
-##	The types to be excluded.  Each type or attribute
-##	must be negated by the caller.
-##	</summary>
-## </param>
-#
-interface(`auth_read_all_symlinks_except_shadow',`
-	refpolicywarn(`$0($*) has been deprecated, use auth_read_all_symlinks_except_auth_files() instead.')
-	auth_read_all_symlinks_except_auth_files($1, $2)
-')
-
 #######################################
 ## <summary>
 ##	Relabel all files on the filesystem, except
@@ -1353,28 +1286,6 @@
 
 ########################################
 ## <summary>
-##	Relabel all files on the filesystem, except
-##	the shadow passwords and listed exceptions.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-## <param name="exception_types" optional="true">
-##	<summary>
-##	The types to be excluded.  Each type or attribute
-##	must be negated by the caller.
-##	</summary>
-## </param>
-#
-interface(`auth_relabel_all_files_except_shadow',`
-	refpolicywarn(`$0($*) has been deprecated, use auth_relabel_all_files_except_auth_files() instead.')
-	auth_relabel_all_files_except_auth_files($1, $2)
-')
-
-########################################
-## <summary>
 ##	Read and write all files on the filesystem, except
 ##	login files and listed exceptions.
 ## </summary>
@@ -1400,28 +1311,6 @@
 
 ########################################
 ## <summary>
-##	Read and write all files on the filesystem, except
-##	the shadow passwords and listed exceptions.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-## <param name="exception_types" optional="true">
-##	<summary>
-##	The types to be excluded.  Each type or attribute
-##	must be negated by the caller.
-##	</summary>
-## </param>
-#
-interface(`auth_rw_all_files_except_shadow',`
-	refpolicywarn(`$0($*) has been deprecated, use auth_rw_all_files_except_auth_files() instead.')
-	auth_rw_all_files_except_auth_files($1, $2)
-')
-
-########################################
-## <summary>
 ##	Manage all files on the filesystem, except
 ##	login files passwords and listed exceptions.
 ## </summary>
@@ -1446,28 +1335,6 @@
 ')
 
 ########################################
-## <summary>
-##	Manage all files on the filesystem, except
-##	the shadow passwords and listed exceptions.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-## <param name="exception_types" optional="true">
-##	<summary>
-##	The types to be excluded.  Each type or attribute
-##	must be negated by the caller.
-##	</summary>
-## </param>
-#
-interface(`auth_manage_all_files_except_shadow',`
-	refpolicywarn(`$0($*) has been deprecated, use auth_manage_all_files_except_auth_files() instead.')
-	auth_manage_all_files_except_auth_files($1, $2)
-')
-
-########################################
 ## <summary>
 ##	Execute utempter programs in the utempter domain.
 ## </summary>
--- a/policy/modules/system/init.if
+++ b/policy/modules/system/init.if
@@ -604,20 +604,6 @@
 
 ########################################
 ## <summary>
-##	Send UDP network traffic to init.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`init_udp_send',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	Get the attributes of initctl.
 ## </summary>
 ## <param name="domain">
@@ -1284,20 +1270,6 @@
 ')
 
 ########################################
-## <summary>
-##	Send UDP network traffic to init scripts.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`init_udp_send_script',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
 ## <summary>
 ##	Allow the specified domain to connect to
 ##	init scripts with a unix socket.
--- a/policy/modules/system/libraries.if
+++ b/policy/modules/system/libraries.if
@@ -314,22 +314,6 @@
 
 ########################################
 ## <summary>
-##	Load and execute functions from generic
-##	lib files as shared libraries.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`libs_use_lib_files',`
-	refpolicywarn(`$0($*) has been deprecated, use libs_use_shared_libs() instead.')
-	libs_use_shared_libs($1)
-')
-
-########################################
-## <summary>
 ##	Create, read, write, and delete generic
 ##	files in library directories.
 ## </summary>
@@ -486,51 +470,3 @@
 	relabel_files_pattern($1, lib_t, { lib_t textrel_shlib_t })
 ')
 
-########################################
-## <summary>
-##	Create an object in lib directories, with
-##	the shared libraries type using a type transition.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-## <param name="object">
-##	<summary>
-##	The object class of the object being created.
-##	</summary>
-## </param>
-#
-interface(`lib_filetrans_shared_lib',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
-##	Create an object in lib directories, with
-##	the shared libraries type using a type transition.  (Deprecated)
-## </summary>
-## <desc>
-##	<p>
-##	Create an object in lib directories, with
-##	the shared libraries type using a type transition.  (Deprecated)
-##	</p>
-##	<p>
-##	lib_filetrans_shared_lib() should be used instead.
-##	</p>
-## </desc>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-## <param name="object">
-##	<summary>
-##	The object class of the object being created.
-##	</summary>
-## </param>
-#
-interface(`files_lib_filetrans_shared_lib',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
--- a/policy/modules/system/logging.if
+++ b/policy/modules/system/logging.if
@@ -233,21 +233,6 @@
 
 ########################################
 ## <summary>
-##	Connect to auditdstored over an unix stream socket.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`logging_stream_connect_auditd',`
-	refpolicywarn(`$0($*) has been deprecated, logging_stream_connect_dispatcher() should be used instead.')
-	logging_stream_connect_dispatcher($1)
-')
-
-########################################
-## <summary>
 ##	Execute a domain transition to run the audit dispatcher.
 ## </summary>
 ## <param name="domain">
--- a/policy/modules/system/miscfiles.if
+++ b/policy/modules/system/miscfiles.if
@@ -126,51 +126,6 @@
 
 ########################################
 ## <summary>
-##	Read SSL certificates.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`miscfiles_read_certs',`
-	miscfiles_read_generic_certs($1)
-	refpolicywarn(`$0() has been deprecated, please use miscfiles_read_generic_certs() instead.')
-')
-
-########################################
-## <summary>
-##	Manage SSL certificates.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`miscfiles_manage_cert_dirs',`
-	miscfiles_manage_generic_cert_dirs($1)
-	refpolicywarn(`$0() has been deprecated, please use miscfiles_manage_generic_cert_dirs() instead.')
-')
-
-########################################
-## <summary>
-##	Manage SSL certificates.
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`miscfiles_manage_cert_files',`
-	miscfiles_manage_generic_cert_files($1)
-	refpolicywarn(`$0() has been deprecated, please use miscfiles_manage_generic_cert_files() instead.')
-')
-
-########################################
-## <summary>
 ##	Read fonts.
 ## </summary>
 ## <param name="domain">
--- a/policy/modules/system/mount.if
+++ b/policy/modules/system/mount.if
@@ -109,32 +109,6 @@
 
 ########################################
 ## <summary>
-##	Allow the mount domain to send nfs requests for mounting
-##	network drives
-## </summary>
-## <desc>
-##	<p>
-##	Allow the mount domain to send nfs requests for mounting
-##	network drives
-##	</p>
-##	<p>
-##	This interface has been deprecated as these rules were
-##	a side effect of leaked mount file descriptors.  This
-##	interface has no effect.
-##	</p>
-## </desc>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-#
-interface(`mount_send_nfs_client_request',`
-	refpolicywarn(`$0($*) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	Execute mount in the unconfined mount domain.
 ## </summary>
 ## <param name="domain">
--- a/policy/modules/system/selinuxutil.if
+++ b/policy/modules/system/selinuxutil.if
@@ -305,60 +305,6 @@
 	dontaudit $1 newrole_t:fd use;
 ')
 
-#######################################
-## <summary>
-##	Execute restorecon in the restorecon domain.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed to transition.
-##	</summary>
-## </param>
-#
-interface(`seutil_domtrans_restorecon',`
-	refpolicywarn(`$0($*) has been deprecated, please use seutil_domtrans_setfiles() instead.')
-	seutil_domtrans_setfiles($1)
-')
-
-########################################
-## <summary>
-##	Execute restorecon in the restorecon domain, and
-##	allow the specified role the restorecon domain,
-##	and use the caller's terminal.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed to transition.
-##	</summary>
-## </param>
-## <param name="role">
-##	<summary>
-##	Role allowed access.
-##	</summary>
-## </param>
-## <rolecap/>
-#
-interface(`seutil_run_restorecon',`
-	refpolicywarn(`$0($*) has been deprecated, please use seutil_run_setfiles() instead.')
-	seutil_run_setfiles($1,$2)
-')
-
-########################################
-## <summary>
-##	Execute restorecon in the caller domain.  (Deprecated)
-## </summary>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-## <rolecap/>
-#
-interface(`seutil_exec_restorecon',`
-	refpolicywarn(`$0($*) has been deprecated, please use seutil_exec_setfiles() instead.')
-	seutil_exec_setfiles($1)
-')
-
 ########################################
 ## <summary>
 ##	Execute run_init in the run_init domain.
@@ -646,33 +592,6 @@
 ')
 
 #######################################
-## <summary>
-##	Create, read, write, and delete
-##	the general selinux configuration files.  (Deprecated)
-## </summary>
-## <desc>
-##	<p>
-##	Create, read, write, and delete
-##	the general selinux configuration files.
-##	</p>
-##	<p>
-##	This interface has been deprecated, please
-##	use the seutil_manage_config() interface instead.
-##	</p>
-## </desc>
-## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
-## </param>
-## <rolecap/>
-#
-interface(`seutil_manage_selinux_config',`
-	refpolicywarn(`$0($*) has been deprecated. Please use seutil_manage_config() instead.')
-	seutil_manage_config($1)
-')
-
-#######################################
 ## <summary>
 ##	Create, read, write, and delete
 ##	the general selinux configuration files.
--- a/policy/modules/system/unconfined.if
+++ b/policy/modules/system/unconfined.if
@@ -131,56 +131,6 @@
 
 ########################################
 ## <summary>
-##	Add an alias type to the unconfined domain.  (Deprecated)
-## </summary>
-## <desc>
-##	<p>
-##	Add an alias type to the unconfined domain.  (Deprecated)
-##	</p>
-##	<p>
-##	This is added to support targeted policy.  Its
-##	use should be limited.  It has no effect
-##	on the strict policy.
-##	</p>
-## </desc>
-## <param name="domain">
-##	<summary>
-##	New alias of the unconfined domain.
-##	</summary>
-## </param>
-#
-interface(`unconfined_alias_domain',`
-	refpolicywarn(`$0($1) has been deprecated.')
-')
-
-########################################
-## <summary>
-##	Add an alias type to the unconfined execmem
-##	program file type.  (Deprecated)
-## </summary>
-## <desc>
-##	<p>
-##	Add an alias type to the unconfined execmem
-##	program file type.  (Deprecated)
-##	</p>
-##	<p>
-##	This is added to support targeted policy.  Its
-##	use should be limited.  It has no effect
-##	on the strict policy.
-##	</p>
-## </desc>
-## <param name="domain">
-##	<summary>
-##	New alias of the unconfined execmem program type.
-##	</summary>
-## </param>
-#
-interface(`unconfined_execmem_alias_program',`
-	refpolicywarn(`$0($1) has been deprecated.')
-')
-
-########################################
-## <summary>
 ##	Transition to the unconfined domain.
 ## </summary>
 ## <param name="domain">
--- a/policy/modules/system/userdomain.if
+++ b/policy/modules/system/userdomain.if
@@ -405,47 +405,6 @@
 
 #######################################
 ## <summary>
-##	The template for creating a user xwindows client.  (Deprecated)
-## </summary>
-## <param name="userdomain_prefix">
-##	<summary>
-##	The prefix of the user domain (e.g., user
-##	is the prefix for user_t).
-##	</summary>
-## </param>
-## <rolebase/>
-#
-template(`userdom_xwindows_client_template',`
-	refpolicywarn(`$0() has been deprecated, please use xserver_role() instead.')
-	gen_require(`
-		type $1_t, user_tmpfs_t;
-	')
-
-	dev_rw_xserver_misc($1_t)
-	dev_rw_power_management($1_t)
-	dev_read_input($1_t)
-	dev_read_misc($1_t)
-	dev_write_misc($1_t)
-	# open office is looking for the following
-	dev_getattr_agp_dev($1_t)
-	dev_dontaudit_rw_dri($1_t)
-	# GNOME checks for usb and other devices:
-	dev_rw_usbfs($1_t)
-
-	xserver_user_x_domain_template($1, $1_t, user_tmpfs_t)
-	xserver_xsession_entry_type($1_t)
-	xserver_dontaudit_write_log($1_t)
-	xserver_stream_connect_xdm($1_t)
-	# certain apps want to read xdm.pid file
-	xserver_read_xdm_pid($1_t)
-	# gnome-session creates socket under /tmp/.ICE-unix/
-	xserver_create_xdm_tmp_sockets($1_t)
-	# Needed for escd, remove if we get escd policy
-	xserver_manage_xdm_tmp_files($1_t)
-')
-
-#######################################
-## <summary>
 ##	The template for allowing the user to change passwords.
 ## </summary>
 ## <param name="userdomain_prefix">
@@ -1215,7 +1174,7 @@
 	# Necessary for managing /boot/efi
 	fs_manage_dos_files($1)
 
-	mls_process_read_up($1)
+	mls_process_read_all_levels($1)
 	mls_file_read_all_levels($1)
 	mls_file_upgrade($1)
 	mls_file_downgrade($1)
--- a/policy/modules/kernel/kernel.te
+++ b/policy/modules/kernel/kernel.te
@@ -272,8 +272,8 @@
 
 mcs_process_set_categories(kernel_t)
 
-mls_process_read_up(kernel_t)
-mls_process_write_down(kernel_t)
+mls_process_read_all_levels(kernel_t)
+mls_process_write_all_levels(kernel_t)
 mls_file_write_all_levels(kernel_t)
 mls_file_read_all_levels(kernel_t)
 
--- a/policy/modules/system/udev.te
+++ b/policy/modules/system/udev.te
@@ -127,7 +127,7 @@
 mls_file_write_all_levels(udev_t)
 mls_file_upgrade(udev_t)
 mls_file_downgrade(udev_t)
-mls_process_write_down(udev_t)
+mls_process_write_all_levels(udev_t)
 
 selinux_get_fs_mount(udev_t)
 selinux_validate_context(udev_t)
--- a/policy/modules/roles/secadm.te
+++ b/policy/modules/roles/secadm.te
@@ -23,7 +23,7 @@
 
 domain_obj_id_change_exemption(secadm_t)
 
-mls_process_read_up(secadm_t)
+mls_process_read_all_levels(secadm_t)
 mls_file_read_all_levels(secadm_t)
 mls_file_write_all_levels(secadm_t)
 mls_file_upgrade(secadm_t)
--- a/policy/modules/roles/sysadm.te
+++ b/policy/modules/roles/sysadm.te
@@ -27,7 +27,7 @@
 
 corecmd_exec_shell(sysadm_t)
 
-mls_process_read_up(sysadm_t)
+mls_process_read_all_levels(sysadm_t)
 
 ubac_process_exempt(sysadm_t)
 ubac_file_exempt(sysadm_t)
--- a/policy/modules/system/setrans.te
+++ b/policy/modules/system/setrans.te
@@ -64,7 +64,7 @@
 mls_file_write_all_levels(setrans_t)
 mls_net_receive_all_levels(setrans_t)
 mls_socket_write_all_levels(setrans_t)
-mls_process_read_up(setrans_t)
+mls_process_read_all_levels(setrans_t)
 mls_socket_read_all_levels(setrans_t)
 
 selinux_compute_access_vector(setrans_t)
