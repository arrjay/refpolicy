From: =?UTF-8?q?Mika=20Pfl=C3=BCger?= <debian@mikapflueger.de>
Date: Sun, 4 Mar 2012 00:27:42 +0100
Subject: Logrotate policy adjustments: * Dontaudit logrotate search access to
 unconfined_home_dir_t * Allow logrotate access to utmp files

---
 policy/modules/admin/logrotate.te |   11 +++++++++--
 1 files changed, 9 insertions(+), 2 deletions(-)

diff --git a/policy/modules/admin/logrotate.te b/policy/modules/admin/logrotate.te
index a8f15b2..d23f0ef 100644
--- a/policy/modules/admin/logrotate.te
+++ b/policy/modules/admin/logrotate.te
@@ -103,9 +103,12 @@ files_manage_generic_spool(logrotate_t)
 files_manage_generic_spool_dirs(logrotate_t)
 files_getattr_generic_locks(logrotate_t)
 
-# cjp: why is this needed?
+# logrotate has to restart some daemons
 init_domtrans_script(logrotate_t)
 
+# for runlevel
+init_dontaudit_write_utmp(logrotate_t)
+
 logging_manage_all_logs(logrotate_t)
 logging_send_syslog_msg(logrotate_t)
 logging_send_audit_msgs(logrotate_t)
@@ -122,7 +125,7 @@ userdom_use_unpriv_users_fds(logrotate_t)
 
 cron_system_entry(logrotate_t, logrotate_exec_t)
 cron_search_spool(logrotate_t)
-
+ 
 mta_send_mail(logrotate_t)
 
 ifdef(`distro_debian', `
@@ -142,6 +145,10 @@ optional_policy(`
 ')
 
 optional_policy(`
+	unconfined_dontaudit_search_home_dirs(logrotate_t)
+')
+
+optional_policy(`
 	acct_domtrans(logrotate_t)
 	acct_manage_data(logrotate_t)
 	acct_exec_data(logrotate_t)
