From: Russell Coker <russell@coker.com.au>
Date: Sun, 21 Oct 2012 03:47:59 +0200
Subject: Allow watchdog_t to read syslog pid files for process watching

---
 policy/modules/services/watchdog.te |    4 ++++
 policy/modules/system/logging.if    |   18 ++++++++++++++++++
 2 files changed, 22 insertions(+)

diff --git a/policy/modules/services/watchdog.te b/policy/modules/services/watchdog.te
index 28088ad..221b788 100644
--- a/policy/modules/services/watchdog.te
+++ b/policy/modules/services/watchdog.te
@@ -93,6 +93,10 @@ optional_policy(`
 ')
 
 optional_policy(`
+	logging_read_syslog_pid_file(watchdog_t)
+')
+
+optional_policy(`
 	nis_use_ypbind(watchdog_t)
 ')
 
diff --git a/policy/modules/system/logging.if b/policy/modules/system/logging.if
index f31fca6..b657972 100644
--- a/policy/modules/system/logging.if
+++ b/policy/modules/system/logging.if
@@ -607,6 +607,24 @@ interface(`logging_create_devlog_dev',`
 
 ########################################
 ## <summary>
+##	Read the syslogd pid file
+## </summary>
+## <param name="domain">
+##	<summary>
+##	Domain allowed access.
+##	</summary>
+## </param>
+#
+interface(`logging_read_syslog_pid_file',`
+	gen_require(`
+		type syslogd_var_run_t;
+	')
+
+	allow $1 syslogd_var_run_t:file read_file_perms;
+')
+
+########################################
+## <summary>
 ##	Connect to the syslog control unix stream socket.
 ## </summary>
 ## <param name="domain">
