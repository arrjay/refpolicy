Description: Allow nrpe to read it's config fils
Author: Russell Coker <russell@coker.com.au>
Last-Update: 2012-06-16

--- a/policy/modules/services/nagios.te
+++ b/policy/modules/services/nagios.te
@@ -188,7 +188,9 @@
 
 domtrans_pattern(nrpe_t, nagios_checkdisk_plugin_exec_t, nagios_checkdisk_plugin_t)
 
+allow nrpe_t nagios_etc_t:dir list_dir_perms;
 read_files_pattern(nrpe_t, nagios_etc_t, nagios_etc_t)
+read_files_pattern(nrpe_t, nrpe_etc_t, nrpe_etc_t)
 files_search_etc(nrpe_t)
 
 manage_files_pattern(nrpe_t, nrpe_var_run_t, nrpe_var_run_t)
@@ -246,9 +248,9 @@
 storage_getattr_fixed_disk_dev(nrpe_t)
 init_read_utmp(nrpe_t)
 
-term_dontaudit_getattr_all_user_ttys(nrpe_t)
+term_dontaudit_getattr_all_ttys(nrpe_t)
 term_dontaudit_getattr_unallocated_ttys(nrpe_t)
-term_dontaudit_getattr_all_user_ptys(nrpe_t)
+term_dontaudit_getattr_all_ptys(nrpe_t)
 
 optional_policy(`
 	inetd_tcp_service_domain(nrpe_t, nrpe_exec_t)
