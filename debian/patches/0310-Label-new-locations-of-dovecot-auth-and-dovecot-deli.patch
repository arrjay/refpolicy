From: Russell Coker <russell@coker.com.au>
Date: Sun, 21 Oct 2012 04:17:49 +0200
Subject: Label new locations of dovecot auth and dovecot deliver; Label
 dovecot libraries
Bug-Debian: http://bugs.debian.org/690225

---
 policy/modules/services/dovecot.fc |    2 +-
 policy/modules/services/lda.fc     |    3 ++-
 policy/modules/system/libraries.fc |    1 +
 3 files changed, 4 insertions(+), 2 deletions(-)

Index: refpolicy/policy/modules/services/dovecot.fc
===================================================================
--- refpolicy.orig/policy/modules/services/dovecot.fc	2012-10-21 04:32:44.463416013 +0200
+++ refpolicy/policy/modules/services/dovecot.fc	2012-10-21 04:32:47.299516584 +0200
@@ -24,7 +24,7 @@
 /usr/share/ssl/private/dovecot\.pem --	gen_context(system_u:object_r:dovecot_cert_t,s0)
 
 ifdef(`distro_debian', `
-/usr/lib/dovecot/dovecot-auth 	--	gen_context(system_u:object_r:dovecot_auth_exec_t,s0)
+/usr/lib/dovecot/auth 	--	gen_context(system_u:object_r:dovecot_auth_exec_t,s0)
 ')
 
 ifdef(`distro_redhat', `
Index: refpolicy/policy/modules/services/lda.fc
===================================================================
--- refpolicy.orig/policy/modules/services/lda.fc	2012-10-21 04:32:44.299410205 +0200
+++ refpolicy/policy/modules/services/lda.fc	2012-10-21 04:32:47.299516584 +0200
@@ -3,6 +3,7 @@
 /usr/bin/maildrop	--	gen_context(system_u:object_r:lda_exec_t,s0)
 /usr/sbin/deliverquota.maildrop	--	gen_context(system_u:object_r:lda_exec_t,s0)
 /usr/lib/dovecot/deliver --	gen_context(system_u:object_r:lda_exec_t,s0)
+/usr/lib/dovecot/dovecot-lda -- gen_context(system_u:object_r:lda_exec_t,s0)
 /usr/bin/mailbot	--	gen_context(system_u:object_r:lda_exec_t,s0)
 
 /etc/courier/maildroprc	--	gen_context(system_u:object_r:lda_etc_t,s0)
Index: refpolicy/policy/modules/system/libraries.fc
===================================================================
--- refpolicy.orig/policy/modules/system/libraries.fc	2012-10-21 04:32:46.883501841 +0200
+++ refpolicy/policy/modules/system/libraries.fc	2012-10-21 04:32:47.299516584 +0200
@@ -147,6 +147,7 @@
 
 /usr/lib64/altivec/libavcodec\.so(\.[^/]*)* --	gen_context(system_u:object_r:textrel_shlib_t,s0)
 /usr/lib(64)?/cedega/.+\.so(\.[^/]*)*	--	gen_context(system_u:object_r:textrel_shlib_t,s0)
+/usr/lib/dovecot/(.*/)?lib.*\.so.*	--	gen_context(system_u:object_r:lib_t,s0)
 /usr/lib/vlc/video_chroma/libi420_rgb_mmx_plugin\.so --	gen_context(system_u:object_r:textrel_shlib_t,s0)
 /usr/lib/vlc/codec/librealvideo_plugin\.so --	gen_context(system_u:object_r:textrel_shlib_t,s0)
 /usr/lib/vlc/codec/libdmo_plugin\.so	--	gen_context(system_u:object_r:textrel_shlib_t,s0)
