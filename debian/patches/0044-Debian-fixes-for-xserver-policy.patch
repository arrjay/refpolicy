From: =?UTF-8?q?Mika=20Pfl=C3=BCger?= <debian@mikapflueger.de>
Date: Fri, 2 Mar 2012 03:37:51 +0100
Subject: Debian fixes for xserver policy

---
 policy/modules/services/xserver.if |    9 +++++----
 policy/modules/services/xserver.te |    1 +
 2 files changed, 6 insertions(+), 4 deletions(-)

Index: refpolicy-2.20110726/policy/modules/services/xserver.if
===================================================================
--- refpolicy-2.20110726.orig/policy/modules/services/xserver.if	2012-06-21 23:35:29.550676083 +1000
+++ refpolicy-2.20110726/policy/modules/services/xserver.if	2012-06-21 23:36:31.511306001 +1000
@@ -526,12 +526,12 @@
 
 ########################################
 ## <summary>
-##	Read all users .Xauthority.
+##    Read all users .Xauthority.
 ## </summary>
 ## <param name="domain">
-##	<summary>
-##	Domain allowed access.
-##	</summary>
+##    <summary>
+##    Domain allowed access.
+##    </summary>
 ## </param>
 #
 interface(`xserver_read_user_xauth',`
@@ -672,6 +672,7 @@
 
 	files_search_tmp($1)
 	stream_connect_pattern($1, xdm_tmp_t, xdm_tmp_t, xdm_t)
+	stream_connect_pattern($1, xdm_var_run_t, xdm_var_run_t, xdm_t)
 ')
 
 ########################################
Index: refpolicy-2.20110726/policy/modules/services/xserver.te
===================================================================
--- refpolicy-2.20110726.orig/policy/modules/services/xserver.te	2012-06-21 23:35:16.898555018 +1000
+++ refpolicy-2.20110726/policy/modules/services/xserver.te	2012-06-21 23:36:31.511306001 +1000
@@ -784,6 +784,7 @@
 optional_policy(`
 	unconfined_domain_noaudit(xserver_t)
 	unconfined_domtrans(xserver_t)
+        unconfined_dbus_send(xserver_t)
 ')
 
 optional_policy(`
