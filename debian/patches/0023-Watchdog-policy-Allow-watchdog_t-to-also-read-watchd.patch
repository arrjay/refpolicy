From: =?UTF-8?q?Mika=20Pfl=C3=BCger?= <debian@mikapflueger.de>
Date: Fri, 2 Mar 2012 02:17:25 +0100
Subject: Watchdog policy: Allow watchdog_t to also read watchdog files.

---
 policy/modules/kernel/devices.if    |    6 +++---
 policy/modules/services/watchdog.te |    2 +-
 2 files changed, 4 insertions(+), 4 deletions(-)

Index: refpolicy-2.20110726/policy/modules/kernel/devices.if
===================================================================
--- refpolicy-2.20110726.orig/policy/modules/kernel/devices.if	2012-06-21 23:35:16.894554980 +1000
+++ refpolicy-2.20110726/policy/modules/kernel/devices.if	2012-06-21 23:35:33.262712101 +1000
@@ -4512,7 +4512,7 @@
 
 ########################################
 ## <summary>
-##	Write to watchdog devices.
+##	Read/Write watchdog devices.
 ## </summary>
 ## <param name="domain">
 ##	<summary>
@@ -4520,12 +4520,12 @@
 ##	</summary>
 ## </param>
 #
-interface(`dev_write_watchdog',`
+interface(`dev_rw_watchdog',`
 	gen_require(`
 		type device_t, watchdog_device_t;
 	')
 
-	write_chr_files_pattern($1, device_t, watchdog_device_t)
+	rw_chr_files_pattern($1, device_t, watchdog_device_t)
 ')
 
 ########################################
Index: refpolicy-2.20110726/policy/modules/services/watchdog.te
===================================================================
--- refpolicy-2.20110726.orig/policy/modules/services/watchdog.te	2012-06-21 23:34:15.218005058 +1000
+++ refpolicy-2.20110726/policy/modules/services/watchdog.te	2012-06-21 23:35:33.262712101 +1000
@@ -54,7 +54,7 @@
 corenet_sendrecv_all_client_packets(watchdog_t)
 
 dev_read_sysfs(watchdog_t)
-dev_write_watchdog(watchdog_t)
+dev_rw_watchdog(watchdog_t)
 # do not care about saving the random seed
 dev_dontaudit_read_rand(watchdog_t)
 dev_dontaudit_read_urand(watchdog_t)
